<!-- Characters View - Header moved to header.html -->
<div x-show="$store.ui.currentView === 'characters'" class="view">

    <!-- Empty State -->
    <div x-show="$store.project.characters.length === 0" class="empty-state">
        <i data-lucide="users" width="64" height="64"></i>
        <p x-text="$store.i18n.t('characters.empty')">No hay personajes creados</p>
        <span class="hint" x-text="$store.i18n.t('characters.emptyHint')">Crea tu primer personaje para comenzar</span>
    </div>

    <!-- Characters Grid -->
    <div x-show="$store.project.characters.length > 0" class="content-grid">
        <template x-for="character in $store.project.characters" :key="character.id">
            <div class="character-card clickable" @click="$store.ui.openModal('editCharacter', character)">
                <div class="character-header">
                    <!-- Avatar con imagen o inicial -->
                    <div class="character-avatar" :style="character.avatar?.url ? 'padding: 0; overflow: hidden;' : ''">
                        <template x-if="character.avatar && character.avatar.url">
                            <img :src="character.avatar.url" style="width: 100%; height: 100%; object-fit: cover;">
                        </template>
                        <template x-if="!character.avatar || !character.avatar.url">
                            <span x-text="character.name.charAt(0).toUpperCase()"></span>
                        </template>
                    </div>
                    <div class="character-info">
                        <div class="character-name" x-text="character.name"></div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div class="character-role" x-text="$store.i18n.t('characters.form.roles.' + character.role)"></div>
                            <!-- Estado vital -->
                            <template x-if="character.currentVitalStatus && character.currentVitalStatus !== 'alive'">
                                <span class="badge"
                                      :style="'font-size: 10px; padding: 3px 8px; background: ' + $store.project.getVitalStatusInfo(character.currentVitalStatus).color + '22; color: ' + $store.project.getVitalStatusInfo(character.currentVitalStatus).color + '; border: 1px solid ' + $store.project.getVitalStatusInfo(character.currentVitalStatus).color + '44;'"
                                      x-text="$store.project.getVitalStatusInfo(character.currentVitalStatus).label"></span>
                            </template>
                        </div>
                    </div>
                </div>
                <div class="character-description" x-text="character.description || $store.i18n.t('characters.form.descriptionPlaceholder')"></div>
                <div class="card-actions mt-lg flex gap-md justify-end">
                    <button class="btn-icon"
                            @click.stop="$store.ui.openModal('vitalStatus', { character: character })"
                            title="Estado vital">
                        <i data-lucide="heart-pulse" width="16" height="16"></i>
                    </button>
                    <button class="btn-icon" @click.stop="if(confirm($store.i18n.t('common.confirmDelete'))) { $store.project.deleteCharacter(character.id); $store.ui.success($store.i18n.t('notifications.success.characterDeleted'), ''); }" :title="$store.i18n.t('common.delete')">
                        <i data-lucide="trash-2" width="16" height="16"></i>
                    </button>
                </div>
            </div>
        </template>
    </div>
</div>