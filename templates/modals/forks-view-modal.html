<!-- Modal para ver forks y diferencias -->
<div class="modal-overlay" x-show="$store.ui.isModalOpen('forksView')" 
     x-transition:enter="transition-opacity ease-out duration-300"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition-opacity ease-in duration-200"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     @click="$store.ui.closeModal('forksView')">
    <div class="modal" @click.stop style="width: 90%; max-width: 1000px; height: 85vh;">
        <div class="modal-header">
            <h2 x-text="$store.i18n.t('versionControl.forksViewTitle') || 'Gestión de Forks'"></h2>
            <button class="modal-close" @click="$store.ui.closeModal('forksView')">
                <i data-lucide="x"></i>
            </button>
        </div>
        
        <div class="modal-body">
            <div class="forks-management-panel" x-data="forksViewComponent()">
                <div class="tabs">
                    <button class="tab-button" 
                            :class="{ 'active': activeTab === 'forks' }" 
                            @click="activeTab = 'forks'"
                            x-text="$store.i18n.t('versionControl.forksList')">
                    </button>
                    <button class="tab-button" 
                            :class="{ 'active': activeTab === 'compare' }" 
                            @click="activeTab = 'compare'"
                            x-text="$store.i18n.t('versionControl.diffsTitle')">
                    </button>
                </div>
                
                <!-- Panel de forks -->
                <div x-show="activeTab === 'forks'" class="tab-content">
                    <div class="section">
                        <h3 x-text="$store.i18n.t('versionControl.forksList')"></h3>
                        <div class="forks-list">
                            <template x-for="fork in forksList" :key="fork.forkProjectId">
                                <div class="fork-item">
                                    <div class="fork-info">
                                        <div class="fork-title" x-text="fork.forkName"></div>
                                        <div class="fork-description" x-text="fork.description || 'Sin descripción'"></div>
                                        <div class="fork-meta">
                                            <span class="fork-date" x-text="'Fecha: ' + new Date(fork.forkedAt).toLocaleString()"></span>
                                        </div>
                                    </div>
                                    <div class="fork-actions">
                                        <button class="btn btn-sm btn-primary" 
                                                x-text="$store.i18n.t('common.open')"
                                                @click="openFork(fork.forkProjectId)">
                                        </button>
                                        <button class="btn btn-sm btn-secondary" 
                                                x-text="$store.i18n.t('common.compare')"
                                                @click="compareWithFork(fork.forkProjectId)">
                                        </button>
                                    </div>
                                </div>
                            </template>
                            <div class="empty-state" x-show="forksList.length === 0">
                                <p x-text="$store.i18n.t('versionControl.noForks')"></p>
                                <p class="empty-state-hint" x-text="$store.i18n.t('versionControl.emptyStateHint') || 'Puedes crear un fork usando el botón de fork en la cabecera'"></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Panel de diferencias -->
                <div x-show="activeTab === 'compare'" class="tab-content">
                    <div class="section">
                        <h3 x-text="$store.i18n.t('versionControl.diffsTitle')"></h3>
                        <div class="diff-controls">
                            <div class="form-group">
                                <label x-text="$store.i18n.t('versionControl.compareFrom')"></label>
                                <select class="form-control" x-model="fromCommit">
                                    <option value="" x-text="$store.i18n.t('versionControl.selectCommit')"></option>
                                    <template x-for="commit in commitHistory" :key="commit.id">
                                        <option :value="commit.id" x-text="commit.id.substring(0, 8) + ' - ' + commit.message"></option>
                                    </template>
                                </select>
                            </div>
                            <div class="form-group">
                                <label x-text="$store.i18n.t('versionControl.compareTo')"></label>
                                <select class="form-control" x-model="toCommit">
                                    <option value="" x-text="$store.i18n.t('versionControl.selectCommit')"></option>
                                    <template x-for="commit in commitHistory" :key="commit.id">
                                        <option :value="commit.id" x-text="commit.id.substring(0, 8) + ' - ' + commit.message"></option>
                                    </template>
                                </select>
                            </div>
                            <button class="btn btn-primary" 
                                    x-text="$store.i18n.t('versionControl.compare')"
                                    @click="compareVersions()"
                                    :disabled="!fromCommit || !toCommit">
                            </button>
                        </div>
                        <div class="diff-result" x-show="diffResult">
                            <h4 x-text="$store.i18n.t('versionControl.changes')"></h4>
                            <div class="diff-content" x-html="diffResult"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary" @click="$store.ui.closeModal('forksView')" 
                    x-text="$store.i18n.t('common.close')"></button>
        </div>
    </div>
</div>